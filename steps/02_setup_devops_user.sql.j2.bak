USE ROLE ACCOUNTADMIN;

-- Create the DevOps role
CREATE OR REPLACE ROLE {{ SNOWFLAKE_DEVOPS_ROLE }};

-- Create the DevOps user and assign the role
CREATE OR REPLACE USER {{ SNOWFLAKE_DEVOPS_USER }}
  PASSWORD = "{{ SNOWFLAKE_DEVOPS_PASSWORD }}"
  DEFAULT_WAREHOUSE = {{ SNOWFLAKE_WAREHOUSE }}
  DEFAULT_ROLE = {{ SNOWFLAKE_DEVOPS_ROLE }}
  MUST_CHANGE_PASSWORD = FALSE;

-- Grant the DevOps role to the DevOps user
GRANT ROLE {{ SNOWFLAKE_DEVOPS_ROLE }} TO USER {{ SNOWFLAKE_DEVOPS_USER }};
